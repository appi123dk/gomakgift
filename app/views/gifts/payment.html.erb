<!-- MAIN CONTENT SECTION -->
<section class="mainContent clearfix stepsWrapper signUp setp5">
  <div class="container">
    <div class="row">
      <div class="col-xs-12">
        <div class="innerWrapper clearfix stepsPage">
          <div class="page-header" style="border-bottom: 0; text-align:center;">
            <h2>결제</h2>
            <h6>Step 2. 시안전송 및 결제를 진행해주세요</h6>
          </div>

          <!-- Wizard -->
          <div class="row progress-wizard" style="border-bottom:0; margin-top: 20px ">

            <div class="col-xs-3 progress-wizard-step complete fullBar">
              <div class="text-center progress-wizard-stepnum">주문 및 고객정보 입력</div>
              <div class="progress"><div class="progress-bar"></div></div>
              <a href="checkout-step-1.html" class="progress-wizard-dot"></a>
            </div>

            <div class="col-xs-3 progress-wizard-step active">
              <div class="text-center progress-wizard-stepnum">결제</div>
              <div class="progress"><div class="progress-bar"></div></div>
              <a href="checkout-step-2.html" class="progress-wizard-dot"></a>
            </div>

            <div class="col-xs-3 progress-wizard-step disabled">
              <div class="text-center progress-wizard-stepnum">시안 확인</div>
              <div class="progress"><div class="progress-bar"></div></div>
              <a href="checkout-step-3.html" class="progress-wizard-dot"></a>
            </div>

            <div class="col-xs-3 progress-wizard-step disabled">
              <div class="text-center progress-wizard-stepnum">제작 및 배송</div>
              <div class="progress"><div class="progress-bar"></div></div>
              <a href="checkout-step-4.html" class="progress-wizard-dot"></a>
            </div>
          </div>

          <!-- ORDER CONTENT SECTION -->
          <div class="page-header">
            <h4>주문내역 확인</h4>
          </div>

          <div class="row">
            <div class="col-xs-12">
              <div class="cartListInner">
                <div class="thanksContent" style="border-bottom: 0px; padding: 35px 15px 25px">
                  <h4 style = "margin: 0px">감사합니다, 주문이 접수되었습니다</h4>
                  <p>주문하신 내역을 다시 한 번 확인해주세요</p>
                   
                </div>
                <div class="table-responsive">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>상품명</th>
                        <th>가격</th>
                        <th>수량</th>
                        <th>소계</th>
                      </tr>
                    </thead>
                    <tbody>
                    <% sub_total = 0 %>
                    <% @order.shoppingcarts.each do |cart| %>
                      <tr>
                        <td class="col-xs-6"><%= cart.product.title %></td>
                        <td class="col-xs-2"><%= (cart.total_price / cart.qty * 10 / 11).to_i %> 원</td>
                        <td class="col-xs-2"><%= cart.qty %> 개</td>
                        <td class="col-xs-2"><%= (cart.total_price * 10 / 11).to_i %> 원</td>
                      </tr>
                      <% sub_total += (cart.total_price * 10 / 11).to_i %>
                    <% end %>
                    </tbody>
                  </table>
                </div>
                <div class="row totalAmountArea" style="margin-left: 0px; margin-right: 0px;">
                  <div class="col-sm-4 col-sm-offset-8 col-xs-12">
                    <ul class="list-unstyled">
                      <li>소계 <span><%= sub_total %> 원</span></li>
                      <li>VAT <span><%= (sub_total * 0.1).to_i %> 원</span></li>
                      <li>결제액 <span class="grandTotal"><%= @order.payment %> 원</span></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- PAYMENT CONTENT SECTION -->
          <div class="page-header">
            <h4>시안 안내</h4>
          </div>
          <% if !@order.is_designed %>
            <div class="row">
              <div class="col-xs-12">
                <div class="cartListInner">
                  <div class="thanksContent" style="padding: 35px 15px 25px">
                    <h4 style = "margin: 0px 0px 10px;">시안 관련 안내사항</h4>
                    <p>1. gomak@gomakculture.com으로 시안을 보내주세요 </p> 
                    <p>2. 시안 확인 후 10분내로 예상 도안을 보내드립니다 </p> 
                    <p>3. 결제는 제작 전까지만 완료해주세요</p> 
                  </div>
                </div>
              </div>
            </div>
          <% else %>
            <div class="row">
              <div class="col-xs-12">
                <div class="cartListInner">
                  <div class="thanksContent" style="border-bottom: 0px; padding: 35px 15px 25px">
                    <h4 style = "margin: 0px">완성된 시안 내역입니다</h4>
                    <p>시안을 확인하신 후 수정사항에 대해 말씀해주세요</p>
                    <p>전화번호 : 010-0000-0000</p> 
                    <p>이메일 : gomak@gomakculture.com</p> 
                     
                  </div>
                  <div class="table-responsive">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>No.</th>
                          <th>상품명</th>
                          <th>생성일</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr style="text-align: center">
                          <td class="col-xs-2">1</td>
                          <td class="col-xs-6">Samsung_씨앗연필_ver_1</td>
                          <td class="col-xs-4">2017-01-04, 17:40</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="thanksContent" style="padding: 35px 15px 25px">
                    <h4 style = "margin: 0px">현재 완성된 시안이 없습니다</h4>
                    <p>010-0000-0000으로 연락주시면 보다 빨리 시안 작업을 진행할 수 있습니다</p>
                  </div>
                </div>
              </div>
            </div>
          <% end %>

          <% if @order.pay_method.nil? %>
            <form method="GET" action="/orders/update_payment/<%= @order.id %>" class="form-horizontal">
              <!-- 결제방법 -->
              <div class="page-header" style="margin-left : 15px; margin-right: 15px">
                <h4>결제정보입력</h4>
              </div>
              <div class="col-sm-4">
                <h5>1. 결제방법선택</h5>
                <div class="form-group thanksContent" style="text-align:center; margin-left: 0px; padding: 20px 30px">
                  <input type="radio" name="pay_method" checked value="bank_account"> 무통장입금
                  <input type="radio" name="pay_method" style="margin-left: 20px" value="card"> 신용카드
                </div>
              </div>
              <!-- 받는사람 정보 입력 -->
              <div class="col-sm-8">
                <h5>2. 결제방법확인</h5>
                <div id="bank_account"> 
                  <div class="form-group" style="margin-left: 0px; margin-right: 0px; border-left: 1px solid #f1f1f1">
                    <div class="row col-sm-12">  
                      <label class="col-sm-2 control-label">입금자 명</label>
                      <div class="col-sm-4">
                        <input type="text" class="form-control deposit_name" name="deposit_name" required>
                        <small>(실제 입금하실때의 이름을 적어주세요)</small>
                      </div>
                      <label class="col-sm-2 control-label">입금하실은행</label>
                      <div class="col-sm-4">
                        <strong>(주)고막컬쳐</strong><br>
                        하나은행 : 644-222-333333
                      </div>
                    </div>
                    <div class="col-sm-offset-1 col-sm-11" style="border-bottom: 1px dotted #a1a1a1; height: 10px"></div>
                    <label class="col-sm-2 control-label" style="margin-top: 10px">증빙발급신청</label>
                    <div class="col-sm-10" style="margin: 10px 0px; padding-top: 5px">
                      <input type="radio" name="receipt_method" checked value="cash_receipt"> 현금영수증
                      <input type="radio" name="receipt_method" style="margin-left: 20px" value="tax"> 세금계산서
                    </div>
                    <div class="col-sm-offset-1 col-sm-11" style="border-bottom: 1px dotted #a1a1a1; height: 10px"></div>
                    <div class="col-sm-2"></div>
                    <!-- 소득공제 여부(현금영수증)에 따른 DIV변경 -->
                    <div id="cash_receipt">
                      <div class="col-sm-offset-2 col-sm-10" style="margin: 10px 0px; padding-top: 5px">
                        <!-- <input type="radio" name="doc_usage" value="personal" checked> 개인소득공제용
                        <input type="radio" name="doc_usage" value="company" style="margin-left: 20px"> 사업자지출증빙용
                        <input type="radio" name="doc_usage" value="no" style="margin-left: 20px"> 신청안함(자진발급) -->
                      </div>
                      <div id="personal">
                        <label class="col-sm-offset-2 col-sm-2 control-label" style="margin-top: 10px">휴대전화번호</label>
                        <div class="col-sm-5" style="margin-top: 10px">
                          <input type="tel" class="form-control cash_receipt_number" name="cash_receipt_number" placeholder="'-' 없이 입력해주세요" required>
                        </div>
                      </div>
                      <!-- <div id="company">
                        <label class="col-sm-offset-2 col-sm-2 control-label" style="margin-top: 10px">사업자등록번호</label>
                        <div class="col-sm-5" style="margin-top: 10px">
                          <input type="tel" class="form-control" name="com_register_number[]" placeholder="'-' 없이 입력해주세요">
                        </div>
                      </div> -->
                      <div class="col-sm-offset-2 col-sm-7" style="margin-top: 20px">
                        <div style="padding: 15px 20px; background-color: #f0f0f0">
                          <ul>
                            <small>
                            <li style="list-style-type: circle;">개인 소득공제용으로 신청하실 경우 국세청으로 자동전송됩니다.</li>
                            <li style="list-style-type: circle;">사업자 지출 증빙용으로 신청하시면 세금계산서로 활용 가능합니다.</li>
                            <li style="list-style-type: circle;">신청안함 선택시 자진신고 대상으로 현금영수증이 자동발행이 됩니다. </li>
                            <li style="list-style-type: circle;">발행 내용은 현금영수증 웹사이트에서 확인 가능합니다. (http://www.taxsave.go.kr)</li>
                            <li style="list-style-type: circle;">증빙은 신청후 3~5일후(영업일 기준) 발급됩니다.</li>
                            </small>
                          </ul>
                        </div>
                      </div>
                    </div>
                    <!-- 끝 -->
                    <!-- 세금계산서 증빙서류 -->
                    <div id="tax">
                      <div id="company_2">
                        <label class="col-sm-2 control-label" style="margin-top: 10px">사업자등록번호</label>
                        <div class="col-sm-5" style="margin-top: 10px">
                          <input type="tel" class="form-control" name="com_register_number_cash" placeholder="'-' 없이 입력해주세요">
                        </div>
                      </div>
                      <div class="col-sm-offset-2 col-sm-7" style="margin-top: 20px">
                        <div style="padding: 15px 20px; background-color: #f0f0f0">
                          <ul>
                            <small>
                              <li style="list-style-type: circle;">증빙은 신청후 3~5일후(영업일 기준) 발급됩니다.</li>
                            </small>
                          </ul>
                        </div>
                      </div>
                    </div>
                    <!-- 끝 -->
                  </div>
                </div>
                <div id="card">
                  <div class="form-group" style="margin-left: 0px; margin-right: 0px; border-left: 1px solid #f1f1f1">
                    <label class="col-sm-2 control-label" style="margin-top: 10px">결제수단</label>
                    <div class="col-sm-10" style="margin: 10px 0px; padding-top: 5px">
                      <input type="radio" name="card_method" checked value="normal_card"> 일반신용카드
                    </div>
                    <div class="col-sm-offset-1 col-sm-11" style="border-bottom: 1px dotted #a1a1a1; height: 10px"></div>
                    <label class="col-sm-2 control-label" style="margin-top: 10px">증빙발급신청</label>
                    <div class="col-sm-10" style="margin: 10px 0px; padding-top: 5px">
                      <input type="radio" name="receipt_method2" checked value="card_receipt"> 신용카드매출전표
                      <input type="radio" name="receipt_method2" style="margin-left: 20px" value="tax"> 세금계산서
                    </div>
                    <div class="col-sm-2"></div>

                    <div id="tax2">
                      <label class="col-sm-2 control-label" style="margin-top: 10px">사업자등록번호</label>
                      <div class="col-sm-5" style="margin-top: 10px">
                        <input type="tel" class="form-control com_register_number_card" name="com_register_number_card" placeholder="'-' 없이 입력해주세요" >
                      </div>
                      <div class="col-sm-offset-2 col-sm-7" style="margin-top: 20px">
                        <div style="padding: 15px 20px; background-color: #f0f0f0">
                          <ul>
                            <small>
                              <li style="list-style-type: circle;">증빙은 신청후 3~5일후(영업일 기준) 발급됩니다.</li>
                            </small>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-xs-12">
                <div class="well well-lg clearfix">
                  <ul class="pager">
                  <li class="previous"><a href="javascript:history.back()">취소</a></li>
                    <li class="next"><button class="btn btn-default" type="submit">결제</a></li>
                  </ul>
                </div>
              </div>
            </form>
          <% else %>
            <div class="page-header">
            <h4>결제 여부</h4>
            </div>
            <div class="row">
              <div class="col-xs-12">
                <div class="cartListInner">
                  <% if @order.pay_method == "bank_account" %>
                    <% if @order.is_payed %>
                      <!-- 결제 완료 시 (카드 or 무통장 입금 확인) -->
                      <div class="thanksContent" style="padding: 35px 15px 25px">
                        <h4 style = "margin: 0px">결제가 완료되었습니다</h4>
                        <p>감사합니다. 증빙서류는 물품과 함께 보내드리도록 하겠습니다</p>
                      </div>
                    <% else %>
                      <!-- 무통장입금 후 입금 미확인 -->
                      <div class="thanksContent" style="padding: 35px 15px 25px">
                        <h4 style = "margin: 0px">아직 입금되지 않았습니다</h4>
                        <p>입금 후, 1~2일이 지나도 확인이 되지 않을 경우 000-0000-0000으로 연락주세요</p>
                        <hr>
                        <p style="margin-bottom: 0px">예금주 : (주)고막컬쳐 </p> 
                        <p>은행 : 하나은행 | 222-332-444455 </p> 
                        <h5 style="margin-bottom: 15px">금액 : 331,400 원</h5> 
                      </div>
                    <% end %>
                  <% elsif @order.pay_method == "card" %>
                    <div class="thanksContent" style="padding: 35px 15px 25px">
                      <h4 style = "margin: 0px">결재가 완료되었습니다</h4>
                      <p>감사합니다. 증빙서류는 물품과 함께 보내드리도록 하겠습니다</p>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</section>


<% content_for :javascript do %>
<!-- <script src="//d1p7wdleee1q2z.cloudfront.net/post/search.min.js"></script> -->
<script type="text/javascript">


$(function() {
  $("#card").hide();
  $("#tax2").hide();
  $("#tax").hide()
  $("#company").hide();
  $("input[name = doc_usage]").change(function(){
    var radioValue = $(this).val();
    if (radioValue == "personal"){
      $("#personal").show();
      $("#company").hide();
    } else if (radioValue == "company") {
      $("#personal").hide();
      $("#company").show();
    } else {
      $("#personal").hide();
      $("#company").hide();
    }
  });

  $("input[name = receipt_method]").change(function(){
    var radioValue = $(this).val();
    if (radioValue == "cash_receipt"){
      $("#cash_receipt").show();
      $("#tax").hide();
      // 무통장입금 현금영수증
      $(".deposit_name").attr('required');
      $(".cash_receipt_number").attr('required');
      $(".com_register_number_card").removeAttr('required');
      $(".com_register_number_cash").removeAttr('required');
    } else {
      $("#cash_receipt").hide();
      $("#tax").show();
      // 무통장입금 세금계산서
      $(".deposit_name").removeAttr('required');
      $(".cash_receipt_number").removeAttr('required');
      $(".com_register_number_card").removeAttr('required');
      $(".com_register_number_cash").attr('required');
    }
  });

  $("input[name = pay_method]").change(function(){
    var radioValue = $(this).val();
    if (radioValue == "bank_account"){
      $("#bank_account").show();
      $("#card").hide();
      $(".com_register_number_card").removeAttr('required');
      $(".deposit_name").attr('required');
      $(".cash_receipt_number").attr('required');
    } else {
      $("#bank_account").hide();
      $("#card").show();
      $(".deposit_name").removeAttr('required');
      $(".cash_receipt_number").removeAttr('required');
      $(".com_register_number_card").attr('required');
    }
  });

  $("input[name = receipt_method2]").change(function(){
    var radioValue = $(this).val();
    if (radioValue == "card_receipt"){
      $("#card_receipt").show();
      $("#tax2").hide();
      // 신용카드 매출전표
      $(".deposit_name").removeAttr('required');
      $(".cash_receipt_number").removeAttr('required');
      $(".com_register_number_card").removeAttr('required');
      $(".com_register_number_cash").removeAttr('required');
    } else {
      $("#card_receipt").hide();
      $("#tax2").show();
      // 신용카드 세금계산서
      $(".deposit_name").removeAttr('required');
      $(".cash_receipt_number").removeAttr('required');
      $(".com_register_number_card").attr('required');
      $(".com_register_number_cash").removeAttr('required');
    }
  });
  
});

</script>

<% end %>















